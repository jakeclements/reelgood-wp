(function(s,t,b,c,k,d,a,h,n){b(t).ready(function(){function u(){var a=b(".time-row-8AM");b(".tribe-week-grid-wrapper").slimScroll({height:"500px",railVisible:!0,alwaysVisible:!0,start:a})}function x(){b(".tribe-event-placeholder").each(function(){var a=b(this).attr("data-event-id"),a=parseInt(b("#tribe-events-event-"+a).outerHeight());b(this).height(a)})}function y(a){a.each(function(){var a=b(this),e=a.next(),p={left:"0",width:"65%"},c={right:"0",width:"65%"};if(e.length){var f=e.offset(),g=[f.left,
f.left+e.outerWidth()],f=[f.top,f.top+e.outerHeight()],d=a.offset(),h=[d.left,d.left+a.outerWidth()],d=[d.top,d.top+a.outerHeight()];g[0]<h[1]&&(g[1]>h[0]&&f[0]<d[1]&&f[1]>d[0])&&(a.is(".overlap-right")?e.css(p).addClass("overlap-left"):(a.is(".overlap-left")||a.css(p),e.css(c).addClass("overlap-right")))}})}function z(){var a=b(".tribe-grid-body .tribe-grid-content-wrap .column > div[id*='tribe-events-event-']"),c=b(".tribe-week-grid-inner-wrap").height();a.each(function(){var a=b(this),e=a.attr("data-hour"),
d=a.attr("data-duration"),f=a.attr("data-min"),e=b('.tribe-week-grid-block[data-hour="'+e+'"]'),e=e.offset().top-e.parent().offset().top-e.parent().scrollTop(),e=parseInt(Math.round(e))+parseInt(f),f=parseInt(c)-parseInt(d)-parseInt(e);0>f&&(d=d+f-14);f={height:d-16+"px"};a.css({height:d+"px",top:e+"px"}).find("a").css(f).parent().css(f)});b("div[id^='tribe-events-event-']").css({visibility:"visible",opacity:"0"}).delay(500).animate({opacity:"1"},{duration:250});y(a);a=b(".tribe-grid-header .tribe-grid-content-wrap .column").outerHeight();
b(".tribe-grid-header .column").height(a);a=b(".tribe-grid-allday .tribe-grid-content-wrap").height();b(".tribe-grid-allday .column").height(a);a=b(".tribe-grid-body").height();b(".tribe-grid-body .tribe-grid-content-wrap .column").height(a)}function A(a){var c=b('.tribe-mobile-day[data-day="'+a+'"]');a=b('.column[title="'+a+'"] .tribe-week-event');a.length&&a.each(function(){var a=b(this);a.tribe_has_attr("data-tribejson")&&(a=a.data("tribejson"),c.append(tribe_tmpl("tribe_tmpl_week_mobile",a)))})}
function B(){var a=b(".tribe-events-mobile-day"),c=b("#tribe-events-content > .tribe-events-grid");b("#tribe-mobile-container").length||b('<div id="tribe-mobile-container" />').insertAfter(c);a.each(function(){var a=b(this).attr("title"),e=b('.tribe-mobile-day[data-day="'+a+'"]'),c=b('.tribe-grid-header .column[title="'+a+'"]').find("span").attr("data-full-date");!e.find("h5").length&&e.find(".tribe-events-mobile").length&&e.prepend('<h5 class="tribe-mobile-day-date">'+c+"</h5>");e=b("#tribe-mobile-container");
c=b('.tribe-mobile-day[data-day="'+a+'"]');c.length?c.show():(e.append('<div class="tribe-mobile-day" data-day="'+a+'"></div>'),A(a))})}function r(a,c){if(C.is(".tribe-mobile"))B();else{x();for(var d=b(".tribe-grid-allday"),p=d.find(".vevent"),g=parseInt(b(".tribe-grid-content-wrap .column").width())-8,f=1;8>f;f++)p.hasClass("tribe-dayspan"+f)&&d.find(".tribe-dayspan"+f).children("div").css("width",g*f+(4*(2*f-2)+(f-1))+"px");b(".tribe-grid-body .column:eq(5), .tribe-grid-body .column:eq(6), .tribe-grid-body .column:eq(7)").addClass("tribe-events-right");
z();a&&"function"===typeof a&&a()}}function v(e,g){if("change_view"!=tribe_events_bar_action&&(e.preventDefault(),!a.ajax_running)){var h=b("#tribe-bar-date");a.popping=!1;g?(a.date=g,c.cur_url=c.base_url+a.date+"/"):h.length&&""!==h.val()?(a.date=h.val(),c.cur_url=c.base_url+a.date+"/"):w?c.cur_url=c.base_url+a.date+"/":(a.date=c.cur_date,c.cur_url=c.base_url+c.cur_date+"/");d.pre_ajax(function(){q()})}}function q(){b("#tribe-events-header");b(".tribe-events-grid").tribe_spin();a.pushcount=0;a.ajax_running=
!0;if(!a.popping&&(a.filter_cats&&(c.cur_url=c.base_url),a.params={action:"tribe_week",eventDate:a.date},a.url_params={},a.category&&(a.params.tribe_event_category=a.category),b(k).trigger("tribe_ev_serializeBar"),a.params=b.param(a.params),a.url_params=b.param(a.url_params),b(k).trigger("tribe_ev_collectParams"),a.pushstate=!0,a.do_string=!1,0<a.pushcount||a.filters))a.pushstate=!1,a.do_string=!0;h.pushstate?(n&&debug.time("Week View Ajax Timer"),b(k).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_weekView_AjaxStart"),
b.post(TribeWeek.ajaxurl,a.params,function(e){a.initial_load=!1;d.enable_inputs("#tribe_events_filters_form","input, select");if(e.success){a.ajax_running=!1;c.ajax_response={total_count:"",view:e.view,max_pages:"",tribe_paged:"",timestamp:(new Date).getTime()};var g="",g=b.isFunction(b.fn.parseHTML)?b.parseHTML(e.html):e.html;b("#tribe-events-content.tribe-events-week-grid").replaceWith(g);r(u(),!1);b("div[id*='tribe-events-event-']").hide().fadeIn("fast");a.page_title=b("#tribe-events-header").data("title");
t.title=a.page_title;a.do_string&&history.pushState({tribe_url_params:a.url_params,tribe_params:a.params},a.page_title,c.cur_url+"?"+a.url_params);a.pushstate&&history.pushState({tribe_url_params:a.url_params,tribe_params:a.params},a.page_title,c.cur_url);b(k).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_weekView_AjaxSuccess");n&&debug.timeEnd("Week View Ajax Timer")}})):s.location=a.url_params.length?c.cur_url+"?"+a.url_params:c.cur_url}var C=b("body"),D=b("#tribe-events"),m=b("#tribe-events-bar"),
l=b("#tribe-events-header"),g=0,w=!1;Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c=this.length>>>0,d=Number(b)||0,d=0>d?Math.ceil(d):Math.floor(d);for(0>d&&(d+=c);d<c;d++)if(d in this&&this[d]===a)return d;return-1});l.length&&(g=l.data("startofweek"));m.addClass("tribe-has-datepicker");a.date=l.data("date");m=[0,1,2,3,4,5,6];l=m.indexOf(g);-1<l&&m.splice(l,1);c.datepicker_opts={format:"yyyy-mm-dd",weekStart:g,daysOfWeekDisabled:m,autoclose:!0};b("#tribe-bar-date").bootstrapDatepicker(c.datepicker_opts).on("changeDate",
function(b){var c=("0"+b.date.getDate()).slice(-2),d=("0"+(b.date.getMonth()+1)).slice(-2),c=b.date.getFullYear()+"-"+d+"-"+c;a.date=c;w=!0;if(h.no_bar()||h.live_ajax()&&h.pushstate)h.reset_on()||v(b,c)});r(u(),!1);b(k).on("tribe_ev_resizeComplete",function(){r(!1,!0)});h.pushstate&&!h.map_view()&&(g="action=tribe_week&eventDate="+a.date,c.params.length&&(g=g+"&"+c.params),a.category&&(g=g+"&tribe_event_category="+a.category),history.replaceState({tribe_params:g,tribe_url_params:c.params},"",location.href),
b(s).on("popstate",function(b){if(b=b.originalEvent.state)a.do_string=!1,a.pushstate=!1,a.popping=!0,a.params=b.tribe_params,a.url_params=b.tribe_url_params,d.pre_ajax(function(){q()}),d.set_form(a.params)}));D.on("click",".tribe-events-nav-previous, .tribe-events-nav-next",function(e){e.preventDefault();a.ajax_running||(e=b(this).find("a"),a.popping=!1,a.date=e.attr("data-week"),c.cur_url=e.attr("href"),d.update_picker(a.date),d.pre_ajax(function(){q()}))});b("form#tribe-bar-form").on("submit",function(a){v(a,
null)});d.snap("#tribe-events-content","body","#tribe-events-footer .tribe-events-nav-previous, #tribe-events-footer .tribe-events-nav-next");b(k).on("tribe_ev_runAjax",function(){q()});n&&debug.info("TEC Debug: tribe-events-week.js successfully loaded");a.view&&n&&debug.timeEnd("Tribe JS Init Timer")})})(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);
